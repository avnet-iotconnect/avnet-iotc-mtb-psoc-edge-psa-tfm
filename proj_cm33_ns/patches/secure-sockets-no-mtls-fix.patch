diff --git a/source/COMPONENT_MBEDTLS/cy_tls.c b/source/COMPONENT_MBEDTLS/cy_tls.c
index 3ca5b6c..f7f66b8 100644
--- a/source/COMPONENT_MBEDTLS/cy_tls.c
+++ b/source/COMPONENT_MBEDTLS/cy_tls.c
@@ -1665,15 +1665,18 @@ cy_rslt_t cy_tls_connect(void *context, cy_tls_endpoint_type_t endpoint, uint32_
     }
 #else
     /* */
-    mbedtls_pk_init( &tls_identity->private_key );
-
-    /* Set the opaque private key id */
-    ret = mbedtls_pk_setup_opaque(&tls_identity->private_key, tls_identity->opaque_private_key_id);
-    if(ret != 0)
+    if (tls_identity)
     {
-        tls_cy_log_msg(CYLF_MIDDLEWARE, CY_LOG_ERR, "Failed to setup opaque key context 0x%x\r\n", ret);
-        result = CY_RSLT_MODULE_TLS_ERROR;
-        goto cleanup;
+        mbedtls_pk_init( &tls_identity->private_key );
+
+        /* Set the opaque private key id */
+        ret = mbedtls_pk_setup_opaque(&tls_identity->private_key, tls_identity->opaque_private_key_id);
+        if(ret != 0)
+        {
+            tls_cy_log_msg(CYLF_MIDDLEWARE, CY_LOG_ERR, "Failed to setup opaque key context 0x%x\r\n", ret);
+            result = CY_RSLT_MODULE_TLS_ERROR;
+            goto cleanup;
+        }
     }
 #endif /* CY_SECURE_SOCKETS_PKCS_SUPPORT */
 #endif /* CY_TFM_PSA_SUPPORTED */
